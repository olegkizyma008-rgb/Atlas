# üöÄ Enhanced Codemap System - v2.0

## Overview

–†–æ–∑—à–∏—Ä–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –∫–æ–¥–µ–º–µ–ø—É –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º –∑–≤–µ—Ä—Ç–∞–Ω–Ω—è–º –¥–æ –∞–Ω–∞–ª—ñ–∑—É –ø—Ä–∏ —Ä–æ–±–æ—Ç—ñ –∑ –∫–æ–¥–æ–º.

## ‚ú® –ù–æ–≤—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

### 1. –†–æ–∑—à–∏—Ä–µ–Ω—ñ —Ä–µ—Å—É—Ä—Å–∏ MCP —Å–µ—Ä–≤–µ—Ä–∞

#### –ê–Ω–∞–ª—ñ—Ç–∏—á–Ω—ñ —Ä–µ—Å—É—Ä—Å–∏:
- `codemap://analysis/summary` - –ö–æ—Ä–æ—Ç–∫–∏–π –∑–≤—ñ—Ç
- `codemap://analysis/dead-code` - –ú–µ—Ä—Ç–≤–∏–π –∫–æ–¥
- `codemap://analysis/cycles` - –¶–∏–∫–ª—ñ—á–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
- `codemap://analysis/complexity` - –ú–µ—Ç—Ä–∏–∫–∏ —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ
- `codemap://analysis/full` - –ü–æ–≤–Ω–∏–π –∞–Ω–∞–ª—ñ–∑

# –ê–Ω–∞–ª—ñ–∑ —è–∫–æ—Å—Ç—ñ –∫–æ–¥—É
analyze_code_quality(file_path)

# –ó–¥–æ—Ä–æ–≤'—è –º–æ–¥—É–ª—è
get_module_health(file_path)
```

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∑–≤–µ—Ä–Ω–µ–Ω–Ω—è –¥–æ –∫–æ–¥–µ–º–µ–ø—É

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –¥–µ—Ç–µ–∫—Ç—É—î —Ç–∏–ø –ø–∏—Ç–∞–Ω–Ω—è —Ç–∞ –∑–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –¥–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤:

#### –¢—Ä–∏–≥–µ—Ä–∏:
- **–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞/–∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ** ‚Üí `codemap://project/dependencies`
- **–ú–µ—Ä—Ç–≤–∏–π –∫–æ–¥** ‚Üí `codemap://analysis/dead-code`
- **–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥** ‚Üí `codemap://recommendations/refactoring`
- **–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è** ‚Üí `codemap://recommendations/testing`
- **–ë–µ–∑–ø–µ–∫–∞** ‚Üí `codemap://recommendations/security`
- **–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å** ‚Üí `codemap://recommendations/performance`

#### –ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ –º–æ–≤–∏:
- –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ (–∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä, –∑–∞–ª–µ–∂–Ω–æ—Å—Ç, –º–µ—Ä—Ç–≤–∏–π, –Ω–µ–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω, —Ç–µ—Å—Ç, –±–µ–∑–ø–µ–∫, –ø—Ä–æ–¥—É–∫—Ç–∏–≤, —à–≤–∏–¥–∫, –æ–ø—Ç–∏–º—ñ–∑–∞—Ü)
- –ê–Ω–≥–ª—ñ–π—Å—å–∫–∞ (architecture, dependency, dead, unused, test, security, performance, speed, optimize)

### 4. –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞ —ñ–Ω–∂–µ–∫—Ü—ñ—è –≤ Cascade

–ú–µ—Ç–æ–¥ `inject_into_cascade_prompt()` –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ:
1. –î–µ—Ç–µ–∫—Ç—É—î —Ç–∏–ø –ø–∏—Ç–∞–Ω–Ω—è
2. –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
3. –î–æ–¥–∞—î –∑–∞–≥–∞–ª—å–Ω–∏–π –æ–≥–ª—è–¥
4. –Ü–Ω–∂–µ–∫—Ç—É—î –≤—Å–µ –≤ –ø—Ä–æ–º–ø—Ç –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

## üìä –ú–µ—Ç—Ä–∏–∫–∏ —Ç–∞ –æ—Ü—ñ–Ω–∫–∏

### –Ø–∫—ñ—Å—Ç—å –∫–æ–¥—É (Quality Score)
- **A** (90-100): –í—ñ–¥–º—ñ–Ω–Ω–∞ —è–∫—ñ—Å—Ç—å
- **B** (80-89): –•–æ—Ä–æ—à–∞ —è–∫—ñ—Å—Ç—å
- **C** (70-79): –ó–∞–¥–æ–≤—ñ–ª—å–Ω–∞ —è–∫—ñ—Å—Ç—å
- **D** (60-69): –ü–æ—Ç—Ä–µ–±—É—î –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è
- **F** (0-59): –ö—Ä–∏—Ç–∏—á–Ω–∞ —è–∫—ñ—Å—Ç—å

### –ó–¥–æ—Ä–æ–≤'—è –º–æ–¥—É–ª—è (Module Health)
- **healthy** (80+): –ú–æ–¥—É–ª—å –≤ –≥–∞—Ä–Ω–æ–º—É —Å—Ç–∞–Ω—ñ
- **needs_attention** (60-79): –ü–æ—Ç—Ä–µ–±—É—î —É–≤–∞–≥–∏
- **critical** (<60): –ö—Ä–∏—Ç–∏—á–Ω–∏–π —Å—Ç–∞–Ω

## üîç –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π–Ω—ñ —Å–∏—Å—Ç–µ–º–∏

### –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥
- –¶–∏–∫–ª—ñ—á–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ (–ö—Ä–∏—Ç–∏—á–Ω–∞)
- –ù–µ–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó (–í–∏—Å–æ–∫–∞)
- –í–∏—Å–æ–∫–µ –∑–≤'—è–∑—É–≤–∞–Ω–Ω—è (–°–µ—Ä–µ–¥–Ω—è)
- –°–∫–ª–∞–¥–Ω–∏–π –≥—Ä–∞—Ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π (–°–µ—Ä–µ–¥–Ω—è)

### –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è
- –ü–æ–∫—Ä–∏—Ç—Ç—è –º–æ–¥—É–ª—ñ–≤ –∑ –≤–∏—Å–æ–∫–∏–º –∑–≤'—è–∑—É–≤–∞–Ω–Ω—è–º
- –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π–Ω—ñ —Ç–µ—Å—Ç–∏ –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö –∫–æ–¥–±–µ–π–∑—ñ–≤
- –†–µ–≥—Ä–µ—Å—ñ–π–Ω—ñ —Ç–µ—Å—Ç–∏ –ø–µ—Ä–µ–¥ –≤–∏–¥–∞–ª–µ–Ω–Ω—è–º –∫–æ–¥—É

### –ë–µ–∑–ø–µ–∫–∞
- –¶–∏–∫–ª—ñ—á–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ —É—Å–∫–ª–∞–¥–Ω—é—é—Ç—å –∞—É–¥–∏—Ç
- –ú–µ—Ä—Ç–≤–∏–π –∫–æ–¥ –∑–±—ñ–ª—å—à—É—î –ø–æ–≤–µ—Ä—Ö–Ω—é –∞—Ç–∞–∫–∏
- –í–∏—Å–æ–∫–µ –∑–≤'—è–∑—É–≤–∞–Ω–Ω—è –ø–æ—à–∏—Ä—é—î –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ

### –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å
- –í–∏–¥–∞–ª–µ–Ω–Ω—è –º–µ—Ä—Ç–≤–æ–≥–æ –∫–æ–¥—É –ø—Ä–∏—Å–∫–æ—Ä—é—î –±—ñ–ª–¥–∏
- –ó–º–µ–Ω—à–µ–Ω–Ω—è –∑–≤'—è–∑—É–≤–∞–Ω–Ω—è –ø–æ–∫—Ä–∞—â—É—î –∫–µ—à—É–≤–∞–Ω–Ω—è
- –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –≥—Ä–∞—Ñ—É –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π

## üéØ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –ë–∞–∑–æ–≤–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
```bash
python3 cascade_pre_task_hook.py --mode context
```

### –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è —Ñ–∞–π–ª—É
```bash
python3 cascade_pre_task_hook.py --mode file-context --file path/to/file.js
```

### –Ü–Ω–∂–µ–∫—Ü—ñ—è –≤ –ø—Ä–æ–º–ø—Ç
```bash
python3 cascade_pre_task_hook.py --mode inject --prompt "–Ø–∫ –ø–æ–∫—Ä–∞—â–∏—Ç–∏ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—É?"
```

### MCP —Å–µ—Ä–≤–µ—Ä
```bash
python3 mcp_codemap_server.py --project ./ --mode stdio
```

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ:
1. –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î –Ω–∞–π–Ω–æ–≤—ñ—à–∏–π –∞–Ω–∞–ª—ñ–∑
2. –î–µ—Ç–µ–∫—Ç—É—î —Ç–∏–ø –ø–∏—Ç–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
3. –í–∏–±–∏—Ä–∞—î —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ñ —Ä–µ—Å—É—Ä—Å–∏
4. –Ü–Ω–∂–µ–∫—Ç—É—î –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤ –ø—Ä–æ–º–ø—Ç

## üìà –ü—Ä–∏–∫–ª–∞–¥–∏

### –ü–∏—Ç–∞–Ω–Ω—è –ø—Ä–æ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—É
```
–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á: "–Ø–∫ –ø–æ–∫—Ä–∞—â–∏—Ç–∏ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç—É?"

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î:
- –ì—Ä–∞—Ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π
- –¶–∏–∫–ª—ñ—á–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
- –ú–µ—Ç—Ä–∏–∫–∏ —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥—É
```

### –ü–∏—Ç–∞–Ω–Ω—è –ø—Ä–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
```
–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á: "–Ø–∫—ñ –º–æ–¥—É–ª—ñ –ø–æ—Ç—Ä–µ–±—É—é—Ç—å –±—ñ–ª—å—à–µ —Ç–µ—Å—Ç—ñ–≤?"

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î:
- –ú–æ–¥—É–ª—ñ –∑ –≤–∏—Å–æ–∫–∏–º –∑–≤'—è–∑—É–≤–∞–Ω–Ω—è–º
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
- –ú–µ—Ç—Ä–∏–∫–∏ —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ
```

### –ü–∏—Ç–∞–Ω–Ω—è –ø—Ä–æ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –∫–æ–¥—É
```
–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á: "–ú–æ–∂–Ω–∞ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ü–µ–π –º–µ—Ä—Ç–≤–∏–π –∫–æ–¥?"

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î:
- –°–ø–∏—Å–æ–∫ –º–µ—Ä—Ç–≤–æ–≥–æ –∫–æ–¥—É
- –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ —Ñ–∞–π–ª—É
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –±–µ–∑–ø–µ–∫–∏
- –†–µ–≥—Ä–µ—Å—ñ–π–Ω—ñ —Ç–µ—Å—Ç–∏
```

## üõ†Ô∏è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

```
codemap-system/
‚îú‚îÄ‚îÄ mcp_codemap_server.py          # MCP —Å–µ—Ä–≤–µ—Ä –∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏
‚îú‚îÄ‚îÄ cascade_pre_task_hook.py     ‚îÇ Tools (callable functions):                             ‚îÇ
‚îÇ  - get_layer_analysis(layer: 1-5)                      ‚îÇ
‚îÇ  - get_dead_code_summary()                             ‚îÇ
‚îÇ  - get_dependency_relationships(file_path)             ‚îÇ
‚îÇ  - get_circular_dependencies()                         ‚îÇ
‚îÇ  - get_quality_report(file_path?)                      ‚îÇ
‚îÇ  - get_analysis_status()                               ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ Advanced Tools (deep analysis):                         ‚îÇ
‚îÇ  - analyze_file_deeply(file_path)                      ‚îÇ
‚îÇ  - compare_functions(file1, func1, file2, func2)       ‚îÇ
‚îÇ  - find_duplicates_in_directory(directory)             ‚îÇ
‚îÇ  - analyze_impact(file_path)                           ‚îÇ
‚îÇ  - classify_files(directory?)                          ‚îÇ
‚îÇ  - generate_refactoring_plan(priority)                 ‚îÇ
‚îÇ  - visualize_dependencies(file_path, depth)            ‚îÇ
‚îî‚îÄ‚îÄ config.yaml                    # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è
‚îî‚îÄ‚îÄ reports/
    ‚îú‚îÄ‚îÄ codemap_analysis.json      # –û—Å–Ω–æ–≤–Ω–∏–π –∑–≤—ñ—Ç
    ‚îú‚îÄ‚îÄ CODEMAP_SUMMARY.md         # Markdown –∑–≤—ñ—Ç
    ‚îî‚îÄ‚îÄ codemap_analysis.html      # HTML –∑–≤—ñ—Ç
```

## üöÄ –ú–∞–π–±—É—Ç–Ω—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è

- [ ] –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ Git –¥–ª—è —ñ—Å—Ç–æ—Ä–∏—á–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É
- [ ] –ú–∞—à–∏–Ω–Ω–µ –Ω–∞–≤—á–∞–Ω–Ω—è –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º
- [ ] –†–µ–∞–ª-—Ç–∞–π–º –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —è–∫–æ—Å—Ç—ñ
- [ ] –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ CI/CD
- [ ] –í–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó
- [ ] –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –≤–µ—Ä—Å—ñ–π –ø—Ä–æ–µ–∫—Ç—É
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—ó —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥—É

## üìù –ü—Ä–∏–º—ñ—Ç–∫–∏

- –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∞—Ü—é—î –∑ Python, JavaScript, TypeScript —Ñ–∞–π–ª–∞–º–∏
- –ê–Ω–∞–ª—ñ–∑ –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è –ø—Ä–∏ –∫–æ–∂–Ω—ñ–π –∑–º—ñ–Ω—ñ –∫–æ–¥—É
- –ö–æ–Ω—Ç–µ–∫—Å—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —ñ–Ω–∂–µ–∫—Ç—É—î—Ç—å—Å—è –≤ –ø—Ä–æ–º–ø—Ç–∏ Cascade
- –í—Å—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –±–∞–∑—É—é—Ç—å—Å—è –Ω–∞ —Å—Ç–∞—Ç–∏—á–Ω–æ–º—É –∞–Ω–∞–ª—ñ–∑—ñ

## üîó –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ Cascade

–°–∏—Å—Ç–µ–º–∞ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∞ –≤ `.windsurf/workspace.code-workspace`:

```json
{
  "mcp": {
    "servers": {
      "codemap": {
        "command": "python3",
        "args": ["codemap-system/mcp_codemap_server.py"]
      }
    }
  }
}
```

–¶–µ –¥–æ–∑–≤–æ–ª—è—î Cascade –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–≤–µ—Ä—Ç–∞—Ç–∏—Å—è –¥–æ –∫–æ–¥–µ–º–µ–ø—É –ø—Ä–∏ —Ä–æ–±–æ—Ç—ñ.

---

**–í–µ—Ä—Å—ñ—è**: 2.0  
**–û—Å—Ç–∞–Ω–Ω—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è**: 2025-11-18  
**–°—Ç–∞—Ç—É—Å**: –ê–∫—Ç–∏–≤–Ω–∞ —Ä–æ–∑—Ä–æ–±–∫–∞
