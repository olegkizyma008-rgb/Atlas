# ‚ö° –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥—É

**–î–∞—Ç–∞**: 22 –ª–∏—Å—Ç–æ–ø–∞–¥–∞ 2025  
**–í–µ—Ä—Å—ñ—è**: 1.0

---

## üìã –©–æ —Ä–æ–±–∏—Ç–∏ –ø–µ—Ä—à–∏–º

### 1Ô∏è‚É£ –û–Ω–æ–≤–∏—Ç–∏ `requirements.txt`

–î–æ–¥–∞—Ç–∏ —Ü—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ:

```txt
networkx==3.5
diskcache==5.6.3
radon==6.1.1
watchdog==3.0.0
ast-monitor==0.1.1
websockets==12.0
aiohttp==3.9.0
bandit==1.7.5
memory-profiler==0.61.0
```

–ö–æ–º–∞–Ω–¥–∞:
```bash
pip install -r codemap-system/requirements.txt
```

---

### 2Ô∏è‚É£ –°—Ç–≤–æ—Ä–∏—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫

```bash
mkdir -p codemap-system/core
mkdir -p codemap-system/analysis
mkdir -p codemap-system/windsurf
touch codemap-system/core/__init__.py
touch codemap-system/analysis/__init__.py
touch codemap-system/windsurf/__init__.py
```

---

### 3Ô∏è‚É£ –û—Å–Ω–æ–≤–Ω—ñ —Ñ–∞–π–ª–∏ –¥–ª—è –ø–µ—Ä–µ–ø–∏—Å—É–≤–∞–Ω–Ω—è

#### –§–∞–π–ª 1: `core/architecture_mapper.py` (CRITICAL)

**–©–æ –∑–º—ñ–Ω–∏—Ç–∏**:
- –î–æ–¥–∞—Ç–∏ `networkx` –¥–ª—è –≥—Ä–∞—Ñ—É –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π
- –î–æ–¥–∞—Ç–∏ `diskcache` –¥–ª—è –∫–µ—à—É–≤–∞–Ω–Ω—è
- –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ `_detect_circular_dependencies()`
- –ü–µ—Ä–µ–ø–∏—Å–∞—Ç–∏ `_determine_file_status()` –∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—é –ª–æ–≥—ñ–∫–æ—é
- –î–æ–¥–∞—Ç–∏ AST –ø–∞—Ä—Å–∏–Ω–≥ –¥–ª—è Python

**–ö–ª—é—á–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó**:
```python
def _detect_circular_dependencies(self) -> List[List[str]]:
    """–í–∏—è–≤–∏—Ç–∏ —Ü–∏–∫–ª—ñ—á–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ —á–µ—Ä–µ–∑ DFS"""
    # –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è —á–µ—Ä–µ–∑ networkx.simple_cycles()

def _determine_file_status(self):
    """–¢–æ—á–Ω–æ –≤–∏–∑–Ω–∞—á–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å —Ñ–∞–π–ª—É"""
    # –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ: entry_point, config, unused, deprecated, legacy, in_development

def _should_invalidate_cache(self) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –æ–Ω–æ–≤–∏—Ç–∏ –∫–µ—à"""
    # –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∞—Å–æ–≤—ñ –º—ñ—Ç–∫–∏ —Ñ–∞–π–ª—ñ–≤
```

#### –§–∞–π–ª 2: `core/code_duplication_detector.py` (NEW)

**–©–æ —Ä–æ–±–∏—Ç—å**:
- –í–∏—Ç—è–≥—É—î –±–ª–æ–∫–∏ –∫–æ–¥—É –∑ —Ñ–∞–π–ª—ñ–≤
- –•–µ—à—É—î –±–ª–æ–∫–∏
- –ó–Ω–∞—Ö–æ–¥–∏—Ç—å –¥—É–±–ª—ñ–∫–∞—Ç–∏

**–ö–ª—é—á–æ–≤–∞ —Ñ—É–Ω–∫—Ü—ñ—è**:
```python
def find_duplicates(self, min_lines: int = 5) -> List[Dict]:
    """–ó–Ω–∞–π—Ç–∏ –¥—É–±–ª—ñ–∫–∞—Ç–∏ –∫–æ–¥—É"""
    # –í–∏—Ç—è–≥—É—î–º–æ –±–ª–æ–∫–∏, —Ö–µ—à—É—î–º–æ, –∑–Ω–∞—Ö–æ–¥–∏–º–æ –¥—É–±–ª—ñ–∫–∞—Ç–∏
```

#### –§–∞–π–ª 3: `windsurf/mcp_architecture_server.py` (REWRITE)

**–©–æ –¥–æ–¥–∞—Ç–∏**:
- WebSocket –ø—ñ–¥—Ç—Ä–∏–º–∫–∞
- –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Ñ–∞–π–ª—ñ–≤ —á–µ—Ä–µ–∑ `watchdog`
- –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ Windsurf
- Real-time –æ–Ω–æ–≤–ª–µ–Ω–Ω—è

**–ù–æ–≤—ñ –∫–ª–∞—Å–∏**:
```python
class ArchitectureWebSocketServer:
    """WebSocket –¥–ª—è real-time –æ–Ω–æ–≤–ª–µ–Ω—å"""

class FileChangeHandler:
    """–°–ª—ñ–¥–∫—É–≤–∞–Ω–Ω—è –∑–∞ –∑–º—ñ–Ω–∞–º–∏ —Ñ–∞–π–ª—ñ–≤"""

class WindsurfIntegration:
    """–Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ Windsurf IDE"""
```

---

## üéØ –ü–ª–∞–Ω –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å

### –î–µ–Ω—å 1-2: –Ø–¥—Ä–æ
- [ ] –û–Ω–æ–≤–∏—Ç–∏ `requirements.txt`
- [ ] –ü–µ—Ä–µ–ø–∏—Å–∞—Ç–∏ `architecture_mapper.py`
- [ ] –î–æ–¥–∞—Ç–∏ —Ü–∏–∫–ª—ñ—á–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
- [ ] –î–æ–¥–∞—Ç–∏ –∫–µ—à –Ω–∞ –¥–∏—Å–∫—É

### –î–µ–Ω—å 3-4: –§—É–Ω–∫—Ü—ñ—ó
- [ ] –°—Ç–≤–æ—Ä–∏—Ç–∏ `code_duplication_detector.py`
- [ ] –°—Ç–≤–æ—Ä–∏—Ç–∏ `code_quality_analyzer.py`
- [ ] –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### –î–µ–Ω—å 5: Windsurf
- [ ] –ü–µ—Ä–µ–ø–∏—Å–∞—Ç–∏ MCP —Å–µ—Ä–≤–µ—Ä
- [ ] –î–æ–¥–∞—Ç–∏ WebSocket
- [ ] –î–æ–¥–∞—Ç–∏ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Ñ–∞–π–ª—ñ–≤

---

## üîß –ö–æ–º–∞–Ω–¥–∏ –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

```bash
# –¢–µ—Å—Ç—É–≤–∞—Ç–∏ –∞–Ω–∞–ª—ñ–∑
cd codemap-system
python3 -c "from core.architecture_mapper import ArchitectureMapper; m = ArchitectureMapper(); print(m.analyze_architecture())"

# –¢–µ—Å—Ç—É–≤–∞—Ç–∏ –¥—É–±–ª—ñ–∫–∞—Ç–∏
python3 -c "from core.code_duplication_detector import CodeDuplicationDetector; d = CodeDuplicationDetector('.'); print(d.find_duplicates())"

# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä
python3 windsurf/mcp_architecture_server.py
```

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø—ñ—Ö—É

| –ú–µ—Ç—Ä–∏–∫–∞             | –ü–æ—Ç–æ—á–Ω–æ | –¶—ñ–ª—å   |
| ------------------- | ------- | ------ |
| –¶–∏–∫–ª—ñ—á–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ | ‚ùå       | ‚úÖ      |
| –î—É–±–ª—ñ–∫–∞—Ç–∏           | ‚ùå       | ‚úÖ      |
| –ö–µ—à –Ω–∞ –¥–∏—Å–∫—É        | ‚ùå       | ‚úÖ      |
| Windsurf —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è | üü°       | ‚úÖ      |
| –ß–∞—Å –∞–Ω–∞–ª—ñ–∑—É         | ~30 —Å–µ–∫ | <5 —Å–µ–∫ |

---

## üìù –ü—Ä–∏–º—ñ—Ç–∫–∏

1. **–ù–µ –≤–∏–¥–∞–ª—è–π—Ç–µ —Å—Ç–∞—Ä—ñ —Ñ–∞–π–ª–∏** - –∑–±–µ—Ä—ñ–≥–∞–π—Ç–µ –¥–ª—è —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ
2. **–¢–µ—Å—Ç—É–π—Ç–µ –∫–æ–∂–µ–Ω –∫—Ä–æ–∫** - –Ω–µ —á–µ–∫–∞–π—Ç–µ –∫—ñ–Ω—Ü—è
3. **–ö–æ–º—ñ—Ç—å—Ç–µ —á–∞—Å—Ç–æ** - –º–∞–ª—ñ –∫—Ä–æ–∫–∏ –∫—Ä–∞—â–µ
4. **–î–æ–∫—É–º–µ–Ω—Ç—É–π—Ç–µ –∑–º—ñ–Ω–∏** - –æ–Ω–æ–≤–ª—é–π—Ç–µ README

---

**–ì–æ—Ç–æ–≤–æ –¥–æ —Å—Ç–∞—Ä—Ç—É!** üöÄ
