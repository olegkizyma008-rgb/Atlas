# ===================================
# ATLAS v5.0 - Environment Configuration
# ===================================
# Copy this file to .env and configure your settings
# Last Updated: 2025-10-16 (v5.0 - Pure MCP Edition)

# === SYSTEM ===
NODE_ENV=production
BUILD_NUMBER=dev
LOG_LEVEL=info
FORCE_FREE_PORTS=true

# === LLM API CONFIGURATION (NEW v5.0) ===
# Primary LLM API endpoint (local)
LLM_API_ENDPOINT=http://localhost:4000/v1/chat/completions

# Fallback LLM API endpoint (ngrok tunnel for remote access)
# Example: https://bdd80b70a92d.ngrok-free.app/v1/chat/completions
LLM_API_FALLBACK_ENDPOINT=

# Enable fallback to remote API when local unavailable
LLM_API_USE_FALLBACK=true

# API timeout in milliseconds
LLM_API_TIMEOUT=60000

# === AI BACKEND CONFIGURATION ===
# v5.0: Pure MCP mode only (Goose deprecated)
# Backend mode: 'mcp' (recommended) | 'goose' (deprecated) | 'hybrid' (deprecated)
AI_BACKEND_MODE=mcp

# Primary backend for task execution
AI_BACKEND_PRIMARY=mcp

# Disable fallback (strict mode for development/testing)
# - true: System will throw errors on failures (no fallback)
# - false: System will attempt fallback (production safe)
AI_BACKEND_DISABLE_FALLBACK=false

# === MCP RETRY CONFIGURATION (NEW 18.10.2025) ===
# Maximum number of retry attempts for MCP operations
# Default: 1 (changed from 3 to reduce unnecessary retries)
MCP_MAX_ATTEMPTS=1

# Maximum retry attempts specifically for TODO item execution
# Default: 1 (each TODO item will be attempted once)
MCP_ITEM_MAX_ATTEMPTS=1

# Circuit breaker threshold (failures before opening circuit)
# Default: 3 (after 3 consecutive failures, circuit opens)
MCP_CIRCUIT_BREAKER_THRESHOLD=3

# Circuit breaker reset timeout in milliseconds
# Default: 60000 (60 seconds before attempting to close circuit)
MCP_CIRCUIT_BREAKER_RESET_MS=60000

# MCP operation timeout in milliseconds
# Default: 30000 (30 seconds per operation)
MCP_TIMEOUT_MS=30000

# Enable/disable exponential backoff for retries
# Default: true (enabled)
MCP_EXPONENTIAL_BACKOFF=true

# === DEPRECATED: GOOSE DESKTOP (v4.0 Legacy) ===
# WARNING: Goose integration is deprecated in v5.0
# These settings are kept for backward compatibility only
# Will be removed in future versions
# GOOSE_BIN=/Applications/Goose.app/Contents/MacOS/goose
# GOOSE_DESKTOP_PATH=/Applications/Goose.app/Contents/MacOS/goose
# GOOSE_SERVER_PORT=3000
# GOOSE_PORT=3000
# GOOSE_DISABLE_KEYRING=1
# GITHUB_TOKEN=your_github_token_here

# === TTS & VOICE ===
REAL_TTS_MODE=true
TTS_DEVICE=mps
TTS_PORT=3001

# === WHISPER CONFIGURATION ===
# Optimized for Mac Studio M1 MAX (Metal GPU)
WHISPER_BACKEND=cpp
WHISPER_DEVICE=metal
WHISPER_PORT=3002
WHISPER_CPP_BIN=/Users/dev/Documents/GitHub/atlas4/third_party/whisper.cpp.upstream/build/bin/whisper-cli
WHISPER_CPP_MODEL=/Users/dev/Documents/GitHub/atlas4/models/whisper/ggml-large-v3.bin
# Mac Studio M1 MAX optimizations:
WHISPER_CPP_NGL=20              # GPU layers (Metal acceleration)
WHISPER_CPP_THREADS=10          # M1 Max has 10 performance cores
WHISPER_CPP_DISABLE_GPU=false   # Keep Metal GPU enabled
WHISPER_SAMPLE_RATE=48000       # High quality audio (v5.0)

# === NETWORK PORTS ===
ORCHESTRATOR_PORT=5101
WEB_PORT=5001
FRONTEND_PORT=5001

# === FEATURES ===
# Mac Studio M1 MAX optimizations
USE_METAL_GPU=true              # Metal GPU for Whisper and TTS
OPTIMIZE_FOR_M1_MAX=true        # Enable M1 MAX specific optimizations
